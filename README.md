# dsk_tools

dsk_tools &mdash; библиотека для работы с образами дискет ретро-компьютеров. На основе библитеки создана программа [DISK Commander](https://github.com/Ptr314/dsk_commander). Подробнее смотрите на соответствующей странице по ссылке.

Также на основе библиотеки подготовлена утилита командной строки fddconv. Она может использоваться следующим образом:

```bash
>fddconv INPUT_FILE parameters and commands
```

Параметры могут быть следующими:
```
    -f, --input_format DDD:FFF  Тип входногоф файла (не обязательно)
    -o, --output OUT_FILE       Выходной файл (обязателен, кроме команд ls и extract)
    -m, --volume XX             Volume ID - десятичный (напр. 254) или 16-ричный (напр. $FE) (не обязательно)
    -b, --binary                Сохранять файлы в исходном виде (см. комментарий к команде extract)
    -v, --verbose               Выводить подробную информацию о ходе работы  (не обязательно)
    -h, --help                  Вывод помощи
```
Команды для работы с образом:
```
    -l, --ls                    Вывести список файлов
    -a, --add FILE              Добавить файл (допускается несколько раз)
    -d, --delete FILE           Удалить файл (допускается несколько раз)
    -e, --extract FILE          Извлечь файл* (допускается несколько раз)
```

Примечание для **-e**: для дисков Apple/Агат DOS файлы по умолчанию будут сохраняться в формате FIL. Чтобы сохранить файл в исходном виде, нужно добавить опцию -b (--binary).

Фомат диска в общем случае можно не указывать, он будет определяться автоматически. Если это по какой-то причине не удается, его можно задать явно в виде DDD:FFF, где DDD &ndash; тип диска, а FFF &ndash; тип файловой системы. Значения следующие:


```
DDD:    a140 (Apple/Агат 140k)
        a840 (Agat 840k)
        
FFF:    dos33 (Apple/Агат DOS)
        sos (Sprite OS)
        cpm, cpm-do, cpm-po (CP/M raw, Apple DOS sectors, ProDOS sectors)
```

Формат выходного файла выбирается в соответствии с расширением. Доступны следующие варианты:

- 140к: dsk, nib, nic.
- 840к: dsk, hfe.

Для форматов nib, nic, hfe можно задать Volume ID.

### Примеры использования

Вывести список файлов на диске:

```bash
>fddconv IKP7_140.DSK -l
```

Конвертировать в другой формат:

```bash
>fddconv IKP7_140.DSK -o IKP7_140.nib
```

Добавить файлы и результат сохранить в формате HFE с Volume ID = $AF:

```bash
>fddconv INIT840.DSK -o EXE840.hfe -a exec.fil -a data.fil -m $AF
```

Удалить файл и сохранить образ под другим именем:

```bash
>fddconv EXE840.DSK -o EXE840_del.DSK -d GAME
```

Извлечь два файла и сохранить их в двоичном формате:

```bash
>fddconv IKP7_140.DSK -e hello -e link -b
```

Указать тип входного образа, если он не определяется автоматически, затем вывести список файлов с подробной информацией по ходу работы:

```bash
>fddconv IKP7_140.DSK -f a140:dos33 -l -v
```

